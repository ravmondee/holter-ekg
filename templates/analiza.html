{% extends "base.html" %}
{% block title %}Analiza Wyników EKG{% endblock %}

{% block content %}
    <center>
    <h3 class="display-4">Analiza wyników badań EKG</h3>

        <!-- Przyciski do przesuwania wykresu -->
    <div>
        <a href="{{ url_for('analiza', przesuniecie=-3000) }}" class="btn btn-primary btn-lg">Przesuń wykres w tył o 3000 próbek</a>
        <a href="{{ url_for('analiza', przesuniecie=3000) }}" class="btn btn-primary btn-lg">Przesuń wykres w przód o 3000 próbek</a>
    </div>

    <!-- Wykres przebiegu EKG -->
    <div id="wykres">
        <br>
        <img src="data:image/png;base64,{{ chart_data }}" alt="ECG Signal Plot" class="img-fluid">
    </div>
    <div>
    </div>

    <!-- Tabela z podstawowymi parametrami -->
    <div id="tabela">
        <h2>Podstawowe parametry dla fragmentu EKG</h2>
        <table class="table">
            <tr>
                <th>Czas w sekundach</th>
                <th>Czas w minutach</th>
                <th>Czas w godzinach</th>
                <th>Średni HR</th>
                <th>Max HR</th>
                <th>Min HR</th>
                <th>Liczba zespołów QRS</th>
                <th>Łączna liczba anotacji</th>
                <th>Liczba anotacji N</th>
                <th>Liczba anotacji A</th>
                <th>SDNN</th>
                <th>RMSSD</th>
                <th>PNN50</th>
            </tr>
            <tr>
                <td>{{ czas_s }}</td>
                <td>{{ czas_m }}</td>
                <td>{{ czas_h }}</td>
                <td>{{ avg_hr }}</td>
                <td>{{ max_hr }}</td>
                <td>{{ min_hr }}</td>
                <td>{{ count_qrs }}</td>
                <td>{{ total_ann }}</td>
                <td>{{ count_N }}</td>
                <td>{{ count_A }}</td>
                <td>{{ sdnn }}</td>
                <td>{{ rmssd }}</td>
                <td>{{ pnn50 }}</td>
            </tr>
        </table>
    </div>

    <div id="tabela">
        <h2>Podstawowe parametry dla całego EKG</h2>
        <table class="table">
            <tr>
                <th>Czas w sekundach</th>
                <th>Czas w minutach</th>
                <th>Czas w godzinach</th>
                <th>Średni HR</th>
                <th>Max HR</th>
                <th>Min HR</th>
                <th>Liczba zespołów QRS</th>
                <th>Łączna liczba anotacji</th>
                <th>Liczba anotacji N</th>
                <th>Liczba anotacji A</th>
                <th>SDNN</th>
                <th>RMSSD</th>
                <th>PNN50</th>
                
            </tr>
            <tr>
                <td>{{ time_s }}</td>
                <td>{{ time_m }}</td>
                <td>{{ time_h }}</td>
                <td>{{ avg_hr_all }}</td>
                <td>{{ max_hr_all }}</td>
                <td>{{ min_hr_all }}</td>
                <td>{{ count_qrs_all }}</td>
                <td>{{ total_ann_all }}</td>
                <td>{{ count_N_all }}</td>
                <td>{{ count_A_all }}</td>
                <td>{{ sdnn_all }}</td>
                <td>{{ rmssd_all }}</td>
                <td>{{ pnn50_all }}</td>
            </tr>
        </table>
    </div>

    <!-- Przycisk do wyeksportowania wyników do PDF -->
    <div>
        <form method="get" action="{{ url_for('download_pdf') }}">
            <!-- Dodaj ukryte pole z atrybutem download -->
            <input type="hidden" name="download" value="1">
            <button type="submit" class="btn btn-primary btn-lg">Eksportuj do PDF</button><br><br>
        </form>
    </div>

    <a href="{{ url_for('dashboard') }}" class="btn btn-primary btn-lg">Wróć do strony głównej</a><br><br>
    <form  method="post" action ="{{ url_for('logout') }}">
        <button type="submit" class="btn btn-primary btn-lg">Wyloguj</button>
    </form>

    </center>

{% endblock %}
